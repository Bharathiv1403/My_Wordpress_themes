var GFGEO_IP_Geocoders={provider:gfgeo_options.ip_locator||"ipinfo",ipinfo:{token:gfgeo_options.ip_token||"",retrievePosition:function(e,o){var t=""!=this.token?"/?token="+this.token:"";jQuery.getJSON(gfgeo_options.protocol+"://ipinfo.io"+t,function(t){console.log(t);var d=t.loc.split(",");"undefined"!=typeof d[0]?e(d):o("we were unable to detect your location")}).fail(function(e,t,d){"timeout"==t&&o("The server is not responding"),"error"==t&&o(e.responseJSON.error.title)})}},maxmind:{retrievePosition:function(e,o){e=e,"undefined"!=typeof geoip2&&geoip2.insights(function(o){console.log(o),e([o.location.latitude,o.location.longitude])},function(e){o(e)})}},ipapico:{retrievePosition:function(e,o){jQuery.get("https://ipapi.co/latlong/",function(t){console.log(t);var d=t.split(",");"undefined"!=typeof d[0]?e(d):o("we were unable to detect your location")}).fail(function(e,t,d){o("timeout"==t?"The server is not responding":"error"==t?d:"we were unable to detect your location")})}},ipregistry:{token:gfgeo_options.ip_token||"",retrievePosition:function(e,o){var t=""!=this.token?"/?key="+this.token:"";jQuery.getJSON("https://api.ipregistry.co/"+t,function(o){console.log(o),e([o.location.latitude,o.location.longitude])}).fail(function(e,t,d){"timeout"==t&&o("The server is not responding"),"error"==t&&o(e.responseJSON.message)})}}},GFGeo_Forms={},GF_Geo=function(e,o){this.form_id=e.id,this.page_number=o,this.args=e.gfgeo_args,this.geocoder_id=!1,this.init_load_processing=!1,this.processing={status:!1,element:!1,location:!1,advanced_address:!1,selected_address:"",autocomplete_place:"",found_message:"",hide_error_message:!1,locator_id:"",element_id:""},this.page_locator={triggered:!1},this.map_field_exists=!1,this.autocomplete_triggered=!1,this.ip_locator=gfgeo_options.ip_locator,this.fields=e.geolocation_fields,this.directions_fields=e.directions_fields,this.geocoder_directions_fields=e.geocoder_directions_fields,this.maps={},this.autocompletes={},this.directionsServices={}};GF_Geo.prototype.init=function(){var e=this;jQuery("form#gform_"+e.form_id).attr("data-form_id",e.form_id),"undefined"!=typeof gform&&(e=gform.applyFilters("gfgeo_form_object",e)),"maxmind"==e.ip_locator&&"undefined"==typeof geoip2&&(e.ip_locator=!1);var o,t,d={geocoders:[],addresses:[],pageLocator:!1,directions:[]};jQuery("#entry_form").find(".ginput_container.ginput_container_gfgeo_directions_panel, .ginput_container.ginput_container_gfgeo_directions.trigger-dynamically, .ginput_container.ginput_container_gfgeo_geocoder").closest("tr").hide(),jQuery.each(e.fields,function(i,r){if(o=r.gfgeo_id,t="undefined"!=typeof r.gfgeo_geocoder_id?r.gfgeo_geocoder_id:"","gfgeo_geocoder"==r.type){var s=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+o);1!=s.find(".status").val()&&(1==e.args.is_page_load||1==e.args.is_form_update)&&(jQuery("#gfgeo-geocoder-default-coordinates-"+o).length?1!=s.find(".status").val()&&(1==e.args.is_page_load||1==e.args.is_form_update&&1==e.args.geocode_default_location)&&(e.geocoder_id=o,d.geocoders.push(e.geocoder_id)):1==e.args.is_page_load&&1==r.gfgeo_page_locator&&(d.pageLocator=r))}if("gfgeo_map"==r.type&&jQuery("#gfgeo-map-"+o).length&&1!=r.adminOnly&&(e.map_field_exists=!0,e.render_map(r)),"gfgeo_address"==r.type){var a=jQuery('input.gfgeo-address-field[data-field_id="'+o+'"]');""!=t&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t).length&&(e.address_field_init(a,r),1==e.args.is_page_load&&0!=jQuery.trim(a.val()).length&&1!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t).find(".status").val()&&d.addresses.push(a)),1==r.gfgeo_address_autocomplete&&"undefined"!=typeof a.attr("id")&&e.address_autocomplete(a.attr("id"),r,!1)}"gfgeo_coordinates"==r.type&&""!=t&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t).length&&e.coordinates_field_init(jQuery("#gfgeo-coordinates-wrapper-"+o)),"address"!=r.type||"undefined"!=typeof r.gfgeo_disable_field_geocoding&&1==r.gfgeo_disable_field_geocoding||""!=t&&0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t).length&&e.advanced_address_field_init(jQuery("#field_"+o),r),("text"==r.type||"post_custom_field"==r.type)&&1==r.gfgeo_address_autocomplete&&e.address_autocomplete("input_"+o,r,!1),e.args.is_edit_entry&&"undefined"!=typeof r.gfgeo_dynamic_field_usage&&jQuery(".detail-view#field_"+o).addClass(r.cssClass),("gfgeo_locator_button"===r.type||"gfgeo_address"===r.type||"address"===r.type)&&jQuery(document).on("click","#gfgeo-locator-button-"+o+", #gfgeo-infield-locator-button-"+o,function(){e.processing.status||"undefined"==typeof r.gfgeo_geocoder_id||""==r.gfgeo_geocoder_id.length||(e.geocoder_id=r.gfgeo_geocoder_id,e.processing.locator_id=r.gfgeo_id,e.processing.found_message="undefined"!=typeof r.gfgeo_location_found_message?r.gfgeo_location_found_message:"",e.processing.hide_error_message="undefined"!=typeof r.gfgeo_hide_location_failed_message?r.gfgeo_hide_location_failed_message:!1,0!=e.ip_locator&&(e.processing.ip_locator="undefined"!=typeof r.gfgeo_ip_locator_status?r.gfgeo_ip_locator_status:""),0!=e.ip_locator&&"default"==e.processing.ip_locator?(console.log("IP Address Locator"),e.ip_navigator("ip_locator_button","locator_button_success",!1)):(console.log("HTML5 Locator"),e.navigator("locator_button","locator_button_success",!1)))}),"gfgeo_reset_location_button"===r.type&&jQuery(document).on("click","#gfgeo-reset-location-button-"+o,function(){if(!e.processing.status&&"undefined"!=typeof r.gfgeo_geocoder_id&&r.gfgeo_geocoder_id.length>0){var o=r.gfgeo_geocoder_id;1==o.length?e.clear_fields(o[0],"reset_location_button",!1):jQuery.each(o,function(o,t){setTimeout(function(){e.geocoder_id=t,e.clear_fields(t,"reset_location_button",!1)},300)})}}),"gfgeo_directions"===r.type&&(jQuery("#gfgeo-get-directions-button-"+o).on("click",function(){e.isEmpty(jQuery("#input_"+r.gfgeo_id).val())&&e.isEmpty(jQuery("#input_"+r.id).val())&&e.get_directions(jQuery(this).data("field_id"),!1)}),jQuery("#gfgeo-clear-directions-button-"+o).on("click",function(){var o=jQuery(this).data("field_id"),t=e.directions_fields[o];return""==t.gfgeo_origin_geocoder_id?!1:(geocoderId=t.gfgeo_origin_geocoder_id,void e.clear_directions(t,geocoderId))}),e.isEmpty(jQuery("#input_"+r.gfgeo_id).val())&&e.isEmpty(jQuery("#input_"+r.id).val())?"button"!=r.gfgeo_trigger_directions_method&&d.directions.push([o,!1]):d.directions.push([o,!0]))});var i=500,r=d.geocoders.length,s=d.addresses.length,a=d.directions.length;(r>0||s>0||0!=d.pageLocator||a>0)&&(r+s+a>1&&(e.init_load_processing=!0),jQuery.each(d,function(o,t){if("geocoders"==o&&r>0)jQuery.each(t,function(o,t){setTimeout(function(){e.geocoder_id=t,e["debugger"]("Geocoding default geocoder "+t);var o=jQuery("#gfgeo-geocoder-default-coordinates-"+e.geocoder_id).data();e.geocoder("default_coords_geocoder",[o.latitude,o.longitude],"default_coords_geocoder_success",!1)},i),i+=2e3});else if("addresses"==o&&s>0)jQuery.each(t,function(o,t){setTimeout(function(){e["debugger"]("Geocoding default address "+t.data("field_id")),t.trigger("focusout",[!0])},i),i+=2e3});else if("pageLocator"==o&&0!=t){var n=t;setTimeout(function(){e["debugger"]("Running page locator."),e.page_locator.triggered=!0,e.processing.found_message=n.gfgeo_location_found_message,e.processing.hide_error_message="undefined"!=typeof n.gfgeo_hide_location_failed_message?n.gfgeo_hide_location_failed_message:!1,e.geocoder_id=n.gfgeo_id,0!=e.ip_locator&&(e.processing.ip_locator=void 0!==n.gfgeo_ip_locator_status?n.gfgeo_ip_locator_status:""),pageLocatorExists=!0,0!=e.ip_locator&&"default"==e.processing.ip_locator?e.ip_navigator("ip_page_locator","page_locator_success",!1):e.navigator("page_locator","page_locator_success",!1)},i)}else if("directions"==o&&a>0){var g=r+s;jQuery.each(t,function(o,t){(1==t[1]||g>1||g>0&&0!=d.pageLocator)&&(setTimeout(function(){e["debugger"]("Default Directions "+t[0]),e.get_directions(t[0],!0)},i),i+=2e3)})}setTimeout(function(){e.init_load_processing=!1},200+2e3*r+2e3*s)})),e.map_field_exists&&e.resize_map_on_show()},GF_Geo.prototype["debugger"]=function(e){1==this.args.debugger_enabled&&console.log(e)},GF_Geo.prototype.isEmpty=function(e){return"undefined"!=typeof e&&""!=e?!1:!0},GF_Geo.prototype.inArray=function(e,o){for(var t=0;t<o.length;t++)if(o[t]==e)return t;return-1},GF_Geo.prototype.processing_start=function(e,o){var t=this;jQuery("#gform_wrapper_"+t.form_id).addClass("gfgeo-block-layer"),t.processing.status=!0,t.processing.element=e,t.processing.location=o,t.processing.hide_error_message=!1,jQuery.each(t.maps,function(e,o){t.maps[e].map.setOptions({draggable:!1}),jQuery.each(t.maps[e].markers,function(e,o){o.setDraggable(!1)})}),t["debugger"]("Processing start:"),t["debugger"](t.processing),jQuery("body").find('input[type="submit"], .gfgeo-locator-button, input.gfgeo-address-field, input.gfgeo-coordinates-field, .gfgeo-advanced-address input').prop("disabled",!0)},GF_Geo.prototype.processing_end=function(){var e=this;setTimeout(function(){e.processing={status:!1,element:!1,location:!1,advanced_address:!1,hide_error_message:!1,selected_address:"",autocomplete_place:"",found_message:"",locator_id:"",element_id:""},jQuery.each(e.maps,function(o,t){e.maps[o].map.setOptions({draggable:!0}),jQuery.each(e.maps[o].markers,function(e,o){1==jQuery(this)[0].gfgeoArgs.draggable&&o.setDraggable(!0)})}),jQuery("body").find('input[type="submit"], .gfgeo-locator-button, input.gfgeo-address-field, input.gfgeo-coordinates-field, .gfgeo-advanced-address input').prop("disabled",!1),jQuery("#gform_wrapper_"+e.form_id).removeClass("gfgeo-block-layer"),setTimeout(function(){jQuery(".gfgeo-locator-loader").fadeOut("fast",function(){jQuery(".gfgeo-locator-button").fadeIn()})},500),e["debugger"]("Processing end:"),e["debugger"](e.processing)},300)},GF_Geo.prototype.clear_directions=function(e,o){var t=this;if(!t.init_load_processing&&""!=e.gfgeo_origin_geocoder_id&&-1!=t.inArray(o,e.total_geocoders)){var d=e.gfgeo_id,i=""!=e.gfgeo_route_map_id?e.gfgeo_route_map_id:"",r=".gfgeo-dynamic-field-"+d;if(jQuery("#input_"+e.id+".gfgeo-directions-field-value, #input_"+e.gfgeo_id+".gfgeo-directions-field-value").val(""),(o==e.gfgeo_origin_geocoder_id||o==e.gfgeo_destination_geocoder_id)&&jQuery("#input_"+e.id+"_input, #input_"+e.gfgeo_id+"_input").val(""),jQuery("#input_"+e.id+".gfgeo-directions-field-value, #input_"+e.gfgeo_id+".gfgeo-directions-field-value").val(""),"undefined"!=typeof e.gfgeo_directions_panel_id&&"undefined"!=typeof t.fields[e.gfgeo_directions_panel_id]){var s=t.fields[e.gfgeo_directions_panel_id];jQuery("#input_"+s.id+", #input_"+s.gfgeo_id).val("")}jQuery("#field_"+e.field_key).val(""),jQuery(r).find('input[type="text"], input[type="hidden"], select').val("").trigger("change"),jQuery(r).find('input[type="checkbox"], input[type="radio"]').prop("checked",!1).trigger("change"),"undefined"!=typeof t.directionsServices[d]&&(t.directionsServices[d].response="",null!=t.directionsServices[d].DirectionsRenderer.directions&&(t.directionsServices[d].DirectionsRenderer.set("directions",null),jQuery(t.directionsServices[d].DirectionsRenderer.panel).closest("li, tr").slideUp())),""!=i&&"undefined"!=typeof t.maps[i]&&"undefined"!=typeof t.maps[i].polylines.directions[d]&&t.maps[i].polylines.directions[d].setMap(null),t["debugger"]("Clear Directions: geocoder ID "+o+", Directions ID "+e.gfgeo_id)}},GF_Geo.prototype.clear_fields=function(e,o,t){var d=this;if("map"==o){var i=jQuery("#gfgeo-map-"+d.processing.element_id).data("disable_address_output");if(1==i)return}"address_geocoder"!=o&&"address_autocomplete"!=o&&"failed_geocoding"!=o&&jQuery('.gfgeo-address-field[data-geocoder_id="'+e+'"]').val("").trigger("change"),("failed_geocoding"==o&&"address_geocoder"!=d.processing.element||"address_autocomplete"==o&&1==d.processing.advanced_address)&&jQuery('.gfgeo-address-field[data-geocoder_id="'+e+'"]').val("").trigger("change"),("advanced_address_geocoder"!=o&&"failed_geocoding"!=o||"failed_geocoding"==o&&"advanced_address_geocoder"!=d.processing.element)&&jQuery(".gfgeo-advanced-address-geocoder-id-"+e).val("").trigger("change"),("coords_geocoder"!=o||"reset_location_button"==o)&&jQuery('.gfgeo-coordinates-field[data-geocoder_id="'+e+'"]').val("").trigger("change"),jQuery("input.gfgeo-geocoded-field-"+e+'[type="text"], input.gfgeo-geocoded-field-'+e+'[type="hidden"]').val("").trigger("change");var r=".gfgeo-dynamic-field-"+e;jQuery(r).find('input[type="text"], input[type="hidden"], select').val("").trigger("change"),jQuery(r).find('input[type="checkbox"], input[type="radio"]').prop("checked",!1).trigger("change"),jQuery.isEmptyObject(d.directions_fields)||jQuery.each(d.directions_fields,function(o,t){d.clear_directions(t,e)}),jQuery.isEmptyObject(d.geocoder_directions_fields)||jQuery.each(d.geocoder_directions_fields,function(o,t){d.clear_directions(t,e)}),d["debugger"]("Clear Fields: Geocoder ID"+e+", Element "+o)},GF_Geo.prototype.geocoder_timed_out=function(e){var o=this;o.args.hide_error_messages||o.processing.hide_error_message?console.log(e):alert(e),o.processing_end()},GF_Geo.prototype.geocoder_success=function(e){},GF_Geo.prototype.geocoder_failed=function(e){var o=this,t=o.args.geocoder_failed_error_message[o.processing.element],d=t+". Error: "+e;console.log(d),o.args.hide_error_messages||o.processing.hide_error_message?console.log(t):alert(t),o.clear_fields(o.geocoder_id,"failed_geocoding",!1),o.processing_end()},GF_Geo.prototype.geocoder=function(e,o,t,d){var i=this;if(!i.processing.status){i.processing_start(e,o);var r,s=!1,a=gfgeo_options.country_code;"object"==typeof o?data={latLng:new google.maps.LatLng(o[0],o[1]),region:a}:data={address:o,region:a},geocoder=new google.maps.Geocoder,geocoder.geocode(data,function(a,n){return s?void i.geocoder_timed_out(i.args.geocoder_timeout_message):(clearTimeout(r),n==google.maps.GeocoderStatus.OK?(i["debugger"]("Geocoder Success: Element - "+e+", Results:"),i["debugger"](a),void 0!=t&&0!=t?i[t](a[0]):i.geocoder_success(a[0])):(i["debugger"]("Geocoder Failed: Element "+e+", Results "+n),jQuery(document).trigger("gfgeo_geocoder_failed",[i]),"map"!=e||i.args.verify_map_geocoding?"coords_geocoder"!=e||i.args.verify_coords_geocoding?"undefined"!==d&&0!=d?i[d](n):i.geocoder_failed(n):i.coords_geocoder_failed_allowed(o,n):i.map_geocoder_failed_allowed(o,n)))}),r=setTimeout(function(){s=!0},i.args.geocoder_timeout)}},GF_Geo.prototype.map_geocoder_failed_allowed=function(e,o){var t=this;results={formatted_address:"",address_components:""},t.save_location_fields(results,"map")},GF_Geo.prototype.coords_geocoder_failed_allowed=function(e,o){var t=this;alert("No address found."),results={formatted_address:"",address_components:""},t.save_location_fields(results,"coords_geocoder")},GF_Geo.prototype.navigator_success=function(e){self.save_location_fields(e)},GF_Geo.prototype.navigator_failed=function(e){var o=this;o.args.hide_error_messages||o.processing.hide_error_message?console.log(e):alert(e),o.processing_end()},GF_Geo.prototype.navigator=function(e,o,t){function d(d){r.processing.status=!1,r.geocoder(e,[d.coords.latitude,d.coords.longitude],o,t),r["debugger"]("Navigator Success: Element "+e+", Position:"),r["debugger"](d)}function i(d){0!=r.ip_locator&&"fallback"==r.processing.ip_locator?(console.log("fallback ip locator"),r.ip_navigator(e,o,t)):3==d.code?r.geocoder_timed_out(r.args.navigator_error_messages[d.code]):r[t](r.args.navigator_error_messages[d.code]),r["debugger"]("Navigator Failed: Element "+e+", Message:"),r["debugger"](d)}var r=this;if(o="undefined"==o||0==o?"navigator_success":o,t="undefined"==t||0==t?"navigator_failed":t,navigator.geolocation)r.processing_start(e,[]),jQuery(".gfgeo-locator-button.infield-locator").fadeOut("fast",function(){jQuery(".gfgeo-locator-loader").fadeIn()}),navigator.geolocation.getCurrentPosition(d,i,{timeout:r.args.navigator_timeout,enableHighAccuracy:r.args.high_accuracy});else{if(0==r.ip_locator||"fallback"!=r.processing.ip_locator)return r[t](r.args.navigator_error_messages[5]);r.ip_navigator(e,o,t)}},GF_Geo.prototype.ip_navigator_success=function(e){this.save_location_fields(e)},GF_Geo.prototype.ip_navigator_failed=function(e){console.log(e),this.processing_end()},GF_Geo.prototype.ip_navigator=function(e,o,t){function d(d){r.processing.status=!1,r.geocoder(e,d,o,t),r["debugger"]("IP Navigator Sucess: Element "+e+", Results:"),r["debugger"](d)}function i(o){r[t]("Error:\n\n"+JSON.stringify(o,void 0,4)),r["debugger"]("Navigator Failed: Element "+e+", Message:"),r["debugger"](o)}var r=this;o="undefined"==typeof o||0==o?"ip_navigator_success":o,t="undefined"==typeof t||0==t?"ip_navigator_failed":t,r.processing_start(e,[]),jQuery(".gfgeo-locator-button.infield-locator").fadeOut("fast",function(){jQuery(".gfgeo-locator-loader").fadeIn()}),GFGEO_IP_Geocoders[GFGEO_IP_Geocoders.provider].retrievePosition(d,i)},GF_Geo.prototype.page_locator_success=function(e){var o=this;""!=o.processing.found_message&&void 0!=o.processing.found_message&&alert(o.processing.found_message),o.save_location_fields(e,"page_locator")},GF_Geo.prototype.locator_button_success=function(e){var o=this;""!=o.processing.found_message&&void 0!=o.processing.found_message&&alert(o.processing.found_message),o.save_location_fields(e,"locator_button")},GF_Geo.prototype.address_geocoder_success=function(e){this.save_location_fields(e,"address_geocoder")},GF_Geo.prototype.address_field_init=function(e,o){var t=this,d=!1;e.on("input",function(){d=!0}),e.on(t.args.address_field_event_triggers,function(i,r){var s=!1;if("undefined"!=typeof r?(r=!0,d=!0):r=!1,d&&("keydown"==i.type&&13==i.which||"focusout"==i.type||"mouseleave"==i.type)){"keydown"==i.type&&13==i.which&&i.preventDefault();var a=jQuery(this);setTimeout(function(){if("focusout"==i.type&&1==s)return void(s=!1);if(1==t.autocomplete_triggered)t.autocomplete_triggered=!1,s=!0,d=!1,t["debugger"]("Address geocoding prevented by autocomplete_triggered");else{if(d=!1,0==r&&"undefined"!=typeof o.gfgeo_force_autocomplete_selection&&1==o.gfgeo_force_autocomplete_selection)return"undefined"!=typeof o.gfgeo_force_autocomplete_selection_message&&""!=o.gfgeo_force_autocomplete_selection_message&&alert(o.gfgeo_force_autocomplete_selection_message),e.val("").focus(),!1;t.geocoder_id=a.data("geocoder_id");var n=e.val();0!=jQuery.trim(n).length?(d=!1,t.geocoder("address_geocoder",n,"address_geocoder_success",!1),t["debugger"]("Address geocoding: Entered address "+n+", event type: "+i.type)):(d=!1,t.clear_fields(t.geocoder_id,"address_geocoder",!1),t["debugger"]("Address geocoding; no address - clearing fields. Event type: "+i.type))}},700)}})},GF_Geo.prototype.advanced_address_field_init=function(e,o){var t=this;e.attr("data-geocoder_id",o.gfgeo_geocoder_id).attr("data-field_id",o.gfgeo_id),e.hasClass("detail-view")&&e.find(".gfgeo-advanced-address-geocoder-id").length>0&&e.addClass("gfgeo-advanced-address-geocoder-id-"+o.gfgeo_geocoder_id);var d=e.find(".ginput_container span"),i=jQuery(d.get(0)),r=d.find("input, select"),s=i.find("input"),a=!1,n={address_line_1:"street",address_line_2:"",state:"region_name",city:"city",zip:"postcode",country:"country_name"};"undefined"!=typeof gform&&(n=gform.applyFilters("gfgeo_modify_gform_address_dynamic_output",n,o.gfgeo_id,o,t)),d.each(function(){var e=jQuery(this),t="",d="";e.hasClass("ginput_address_line_1")?t=n.address_line_1:e.hasClass("ginput_address_line_2")?t=n.address_line_2:e.hasClass("ginput_address_state")?t=n.state:e.hasClass("ginput_address_city")?t=n.city:e.hasClass("ginput_address_zip")?t=n.zip:e.hasClass("ginput_address_country")&&(t=n.country),d=e.find('input[type="text"], select'),""!=t&&d.addClass("gfgeo-advanced-address-geocoder-id-"+o.gfgeo_geocoder_id+" gfgeo-advanced-address-"+t+"-"+o.gfgeo_geocoder_id)}),"undefined"!=typeof o.gfgeo_address_autocomplete&&""!=o.gfgeo_address_autocomplete&&(s.addClass("advanced-address-autocomplete").attr("data-geocoder_id",o.gfgeo_geocoder_id),t.address_autocomplete(s.attr("id"),o,!1)),"undefined"!=typeof o.gfgeo_infield_locator_button&&""!=o.gfgeo_infield_locator_button&&jQuery("#gfgeo-advanced-address-field-locator-button-holder-"+o.gfgeo_id).length>0&&(i.addClass("gfgeo-advanced-address-locator-button-enabled"),jQuery("#gfgeo-advanced-address-field-locator-button-holder-"+o.gfgeo_id).detach().contents().unwrap().prependTo(i)),a=!1,r.on("input",function(){a=!0}),e.on("mouseleave",function(e){setTimeout(function(){if(1==t.autocomplete_triggered&&(t.autocomplete_triggered=!1,a=!1),0==GFGeo_Autocomplete_Visible&&a){var d="";r.each(function(){d=d+" "+jQuery(this).val()}),t.geocoder_id=o.gfgeo_geocoder_id,0!=jQuery.trim(d).length?(a=!1,t.geocoder("advanced_address_geocoder",d,"advanced_address_geocoder_success",!1),t["debugger"]("Advanced Address geocoding. Entered address: "+d+". Event type: "+e.type)):(a=!1,t.clear_fields(t.geocoder_id,"advanced_address_geocoder",!1),t["debugger"]("Advanced Address geocoding. No address, clearing fields. Event type: "+e.type))}},700)}),r.on("keydown focusout",function(e){var d=!1;"keydown"==e.type&&13==e.which&&(e.preventDefault(),setTimeout(function(){1==t.autocomplete_triggered?(t.autocomplete_triggered=!1,d=!0,a=!1,t["debugger"]("Address geocoding prevented by autocomplete_triggered")):(a=!1,entered_address="",r.each(function(){entered_address=entered_address+" "+jQuery(this).val()}),t.geocoder_id=o.gfgeo_geocoder_id,0!=jQuery.trim(entered_address).length?(t.geocoder("advanced_address_geocoder",entered_address,"advanced_address_geocoder_success",!1),t["debugger"]("Advanced Address geocoding. Entered address: "+entered_address+". Event type: "+e.type)):(t.clear_fields(t.geocoder_id,"advanced_address_geocoder",!1),t["debugger"]("Advanced Address geocoding. No address, clearing fields. Event type: "+e.type)))},700)),"focusout"==e.type&&a&&(focusFields=r,setTimeout(function(){if(!focusFields.is(":focus")){if("focusout"==e.type&&1==d)return void(d=!1);1==t.autocomplete_triggered?(t.autocomplete_triggered=!1,d=!0,a=!1,t["debugger"]("Address geocoding prevented by autocomplete_triggered")):(entered_address="",focusFields.each(function(){entered_address=entered_address+" "+jQuery(this).val()}),t.geocoder_id=o.gfgeo_geocoder_id,0!=jQuery.trim(entered_address).length?(a=!1,t.geocoder("advanced_address_geocoder",entered_address,"advanced_address_geocoder_success",!1),t["debugger"]("Advanced Address geocoding. Entered address: "+entered_address+". Event type: "+e.type)):(a=!1,t.clear_fields(t.geocoder_id,"advanced_address_geocoder",!1),t["debugger"]("Advanced Address geocoding. No address - clearing fields. Event type: "+e.type)))}},300))})},GF_Geo.prototype.advanced_address_geocoder_success=function(e){this.save_location_fields(e,"advanced_address_geocoder")},GF_Geo.prototype.coordinates_field_init=function(e){var o=this,t=!1,d=e.find("input");d.on("input",function(){t=!0}),d.on("keydown focusout",function(d){"keydown"==d.type&&13==d.which&&(t=!1,d.preventDefault(),o.coordinates_trigger(e,"enter_key")),"focusout"==d.type&&t&&setTimeout(function(){e.find("input").is(":focus")||(t=!1,o.coordinates_trigger(e,"focusout"))},300)})},GF_Geo.prototype.coordinates_trigger=function(e,o){var t=this;t.geocoder_id=e.data("geocoder_id");var d=e.find(".gfgeo-latitude-field").val().replace(/ /g,""),i=e.find(".gfgeo-longitude-field").val().replace(/ /g,"");""==d||""==i?""==d&&""==i?(t.clear_fields(t.geocoder_id,"coordinates_geocoder",!1),t["debugger"]("Coordinates geocoder. Empty value, clearing fields. Event type: "+o)):"enter_key"==o&&alert("You must enter both latitude and longitude."):(t.geocoder("coords_geocoder",[d,i],"coords_geocoder_success",!1),t["debugger"]("Coordinates geocoding. Entered coords: "+d+", "+i+". Event type: "+o))},GF_Geo.prototype.coords_geocoder_success=function(e){this.save_location_fields(e,"coords_geocoder")},GF_Geo.prototype.default_coords_geocoder_success=function(e){this.save_location_fields(e,"default_coords_geocoder")},GF_Geo.prototype.render_map=function(e){var o=this,t=e.gfgeo_id,d=[],i="undefined"!=typeof e.gfgeo_map_default_latitude&&""!=e.gfgeo_map_default_latitude?e.gfgeo_map_default_latitude:40.7827096,r="undefined"!=typeof e.gfgeo_map_default_longitude&&""!=e.gfgeo_map_default_longitude?e.gfgeo_map_default_longitude:-73.965309,s=""!=e.gfgeo_map_type?e.gfgeo_map_type:"ROADMAP",a=""!=e.gfgeo_zoom_level?e.gfgeo_zoom_level:12,n=""!=e.gfgeo_map_scroll_wheel?e.gfgeo_map_scroll_wheel:!0,g="undefined"!=typeof e.gfgeo_map_styles&&""!=e.gfgeo_map_styles?jQuery.parseJSON(e.gfgeo_map_styles):"",_="undefined"!=typeof e.gfgeo_map_bounds_sw_point&&""!=e.gfgeo_map_bounds_sw_point?e.gfgeo_map_bounds_sw_point.split(","):"",c="undefined"!=typeof e.gfgeo_map_bounds_ne_point&&""!=e.gfgeo_map_bounds_ne_point?e.gfgeo_map_bounds_ne_point.split(","):"";if("undefined"!=typeof e.gfgeo_geocoder_id&&""!=e.gfgeo_geocoder_id&&(d="string"!=typeof e.gfgeo_geocoder_id?e.gfgeo_geocoder_id.map(function(e){return e}):[e.gfgeo_geocoder_id]),o.maps[t]={geocodersId:d,fieldData:e,options:{},latlng:{},map:{},latLngBounds:{},markers:{},infoWindows:{},polylines:{directions:{}},polygons:{},draggedMarker:"",clickedMarker:"",moveOnClickMarker:""},o.maps[t].latlng=new google.maps.LatLng(i,r),o.maps[t].options={zoom:parseInt(a),center:o.maps[t].latlng,mapTypeId:google.maps.MapTypeId[s],backgroundColor:"#f1f1f1",scrollwheel:n,styles:g},""!=_&&""!=c){var l=new google.maps.LatLngBounds(new google.maps.LatLng(_[0],_[1]),new google.maps.LatLng(c[0],c[1]));o.maps[t].options.restriction={latLngBounds:l,strictBounds:!1}}o.maps[t].map=new google.maps.Map(document.getElementById("gfgeo-map-"+t),o.maps[t].options),d.length>0&&o.render_markers(t,d),o.map_single_click=!1,google.maps.event.addListener(o.maps[t].map,"click",function(e){o.map_single_click=!0,setTimeout(function(){if(o.map_single_click&&""!=o.maps[t].moveOnClickMarker){var d=o.maps[t].moveOnClickMarker,i=o.fields[d];1==i.gfgeo_move_marker_via_map_click&&(o.maps[t].draggedMarker=d,o.maps[t].markers[d].setPosition(e.latLng),o.geocoder_id=d,o.processing.element_id=t,o.geocoder("map",[e.latLng.lat(),e.latLng.lng()],"map_geocoder_success",!1))}},200)}),google.maps.event.addListener(o.maps[t].map,"dblclick",function(e){o.map_single_click=!1}),jQuery(document).trigger("gfgeo_render_map",[o,e])},GF_Geo.prototype.render_marker=function(e,o,t){var d,i=this,r=i.fields[o],s="undefined"!=typeof r.gfgeo_map_marker_url&&0!=jQuery.trim(r.gfgeo_map_marker_url).length?r.gfgeo_map_marker_url:"",a="undefined"!=typeof r.gfgeo_address_output_disabled?r.gfgeo_address_output_disabled:!1,n=!0,g=i.maps[t],_=!1,c=g.geocodersId.length;if("undefined"!=typeof r.gfgeo_disable_marker_drag&&(n=0==r.gfgeo_disable_marker_drag?!0:!1),"undefined"!=typeof r.gfgeo_move_marker_via_map_click?d=r.gfgeo_move_marker_via_map_click:(d=!1,r.gfgeo_move_marker_via_map_click=!1),1==d&&""==g.moveOnClickMarker&&(g.moveOnClickMarker=o),0==jQuery.trim(jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+o+" input.latitude").val()).length&&1==c){var l=!1;if("undefined"!=typeof r.gfgeo_map_marker_default_latitude&&"undefined"!=typeof r.gfgeo_map_marker_default_longitude&&0!=jQuery.trim(r.gfgeo_map_marker_default_latitude).length&&0!=jQuery.trim(r.gfgeo_map_marker_default_longitude).length&&(l=!0),(""!=s||0==n||1==d||"undefined"!=typeof r.gfgeo_marker_info_window&&0!=jQuery.trim(r.gfgeo_marker_info_window).length)&&(l=!0),0==l&&"undefined"!=typeof i.fields[t]){var p=i.fields[t];e=g.map.getCenter(),s=p.gfgeo_map_marker,n=p.gfgeo_draggable_marker,a=p.gfgeo_disable_address_output,d=p.gfgeo_set_marker_on_click}}var f=new google.maps.Marker({position:e,draggable:n,icon:s,gfgeoArgs:{geocoderID:o,mapId:t,defaultPostion:e,draggable:n,markerUrl:s,disableAddressOutput:a}});return"undefined"!=typeof r.gfgeo_marker_info_window&&0!=jQuery.trim(r.gfgeo_marker_info_window).length&&(_=!0,i.maps[t].infoWindows[o]=new google.maps.InfoWindow({content:'<div if="gfgeo-info-window-wrapper-'+o+'" class="gfgeo-info-window-wrapper"><div class="gfgeo-info-window">'+r.gfgeo_marker_info_window+"</div></div>"})),f.addListener("click",function(){var e=jQuery(this)[0].gfgeoArgs.geocoderID;_&&i.maps[t].infoWindows[e].open(i.maps[t].map,jQuery(this)[0]),g.clickedMarker=e,jQuery(document).trigger("gfgeo_marker_clicked",[jQuery(this)[0],i,e,t]),i["debugger"]("Map marker Clicked. Geocoder ID: "+e+". Map ID: "+t)}),google.maps.event.addListener(f,"dragend",function(e){var o=jQuery(this)[0],d=o.gfgeoArgs.geocoderID,r=i.fields[d];"undefined"!=typeof r.gfgeo_move_marker_via_map_click&&1==r.gfgeo_move_marker_via_map_click&&(i.maps[o.gfgeoArgs.mapId].moveOnClickMarker=d),i.maps[o.gfgeoArgs.mapId].draggedMarker=d,i.geocoder_id=d,i.processing.element_id=t,i.geocoder("map",[e.latLng.lat(),e.latLng.lng()],"map_geocoder_success",!1),jQuery(document).trigger("gfgeo_marker_dragged",[jQuery(this)[0],i,d,t]),i["debugger"]("Map marker dragged. Geocoder ID: "+d+". Map ID: "+t)}),f},GF_Geo.prototype.render_markers=function(e,o){var t,d,r,s,a,n=this;for(n.maps[e].latLngBounds=new google.maps.LatLngBounds,i=0;i<o.length;i++)"undefined"!=typeof n.fields[o[i]]&&(t=o[i],r=n.fields[t],d={},s=40.7827096,a=-73.965309,existLat=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t+" input.latitude").val(),existLng=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+t+" input.longitude").val(),0!=jQuery.trim(existLat).length&&0!=jQuery.trim(existLng).length?(s=existLat,a=existLng):"undefined"!=typeof r.gfgeo_map_marker_default_latitude&&"undefined"!=typeof r.gfgeo_map_marker_default_longitude&&0!=jQuery.trim(r.gfgeo_map_marker_default_latitude).length&&0!=jQuery.trim(r.gfgeo_map_marker_default_longitude).length&&(s=r.gfgeo_map_marker_default_latitude,a=r.gfgeo_map_marker_default_longitude),d=new google.maps.LatLng(s,a),n.maps[e].markers[t]=n.render_marker(d,t,e),"undefined"!=typeof r.gfgeo_map_marker_hidden&&1==r.gfgeo_map_marker_hidden&&n.maps[e].markers[t].setVisible(!1),d=n.maps[e].markers[t].getPosition(),n.maps[e].latLngBounds.extend(d),n.maps[e].markers[t].setMap(n.maps[e].map));1==o.length?n.maps[e].map.panTo(d):n.maps[e].map.fitBounds(n.maps[e].latLngBounds)},GF_Geo.prototype.update_map=function(e,o,t,d){var i=this;if(jQuery("#gfgeo-map-"+e).length&&(i.maps[e].latLng=new google.maps.LatLng(t,d),"undefined"!=typeof i.maps[e].markers[o])){i.maps[e].markers[o].setVisible(!0),i.maps[e].markers[o].setPosition(i.maps[e].latLng),i.maps[e].map.panTo(i.maps[e].latLng),i.maps[e].latLngBounds=new google.maps.LatLngBounds;var r=0;jQuery.each(i.maps[e].markers,function(o,t){r++,i.maps[e].latLngBounds.extend(t.getPosition())}),r>1&&i.maps[e].map.fitBounds(i.maps[e].latLngBounds),setTimeout(function(){i.maps[e].markers[o].setDraggable(i.maps[e].markers[o].gfgeoArgs.draggable)},800),jQuery(document).trigger("gfgeo_update_map",[i.maps[e],i,t,d])}},GF_Geo.prototype.map_geocoder_success=function(e){this.save_location_fields(e,"map")},GF_Geo.prototype.resize_map_on_show=function(){var e=this;"undefined"!=typeof gform&&gform.addAction("gform_post_conditional_logic_field_action",function(o,t,d,i,r){if(!r&&"show"==t){var s=d.replace("#field_","");0!=jQuery("#gfgeo-map-"+s).length&&"undefined"!=typeof e.maps[s]&&(google.maps.event.trigger(e.maps[s].map,"resize"),1==e.maps[s].geocodersId.length?e.maps[s].map.panTo(e.maps[s].latlng):e.maps[s].map.fitBounds(e.maps[s].latLngBounds))}})},GF_Geo.prototype.address_autocomplete=function(e,o,t){var d=this,i=jQuery("#"+e);"0"==d.args.field_autocomplete&&i.on("focusin",function(){jQuery(this).attr("autocomplete","stop")}),i.on("keydown",function(e){13==e.which&&e.preventDefault()});var r={};if("undefined"!=typeof o.gfgeo_address_autocomplete_country&&""!=o.gfgeo_address_autocomplete_country&&(r.componentRestrictions={country:o.gfgeo_address_autocomplete_country}),"undefined"!=typeof o.gfgeo_address_autocomplete_types&&""!=o.gfgeo_address_autocomplete_types&&(r.types=[o.gfgeo_address_autocomplete_types]),"undefined"!=typeof o.gfgeo_autocomplete_restriction_usage){var s,a=!1;if("proximity"==o.gfgeo_autocomplete_restriction_usage){var n="undefined"!=typeof o.gfgeo_autocomplete_proximity_lat&&""!=o.gfgeo_autocomplete_proximity_lat?o.gfgeo_autocomplete_proximity_lat:"",g="undefined"!=typeof o.gfgeo_autocomplete_proximity_lng&&""!=o.gfgeo_autocomplete_proximity_lng?o.gfgeo_autocomplete_proximity_lng:"",_="undefined"!=typeof o.gfgeo_autocomplete_proximity_radius&&""!=o.gfgeo_autocomplete_proximity_radius?o.gfgeo_autocomplete_proximity_radius:"";
if(""!=n&&""!=g){a=!0;var c=new google.maps.Circle({center:{lat:parseFloat(n),lng:parseFloat(g)},radius:parseInt(_)});s=c.getBounds()}}else if("area_bounds"==o.gfgeo_autocomplete_restriction_usage){var l="undefined"!=typeof o.gfgeo_autocomplete_bounds_sw_point&&""!=o.gfgeo_autocomplete_bounds_sw_point?o.gfgeo_autocomplete_bounds_sw_point.split(","):"",p="undefined"!=typeof o.gfgeo_autocomplete_bounds_ne_point&&""!=o.gfgeo_autocomplete_bounds_ne_point?o.gfgeo_autocomplete_bounds_ne_point.split(","):"";""!=l&&""!=p&&(a=!0,s=new google.maps.LatLngBounds(new google.maps.LatLng(l[0],l[1]),new google.maps.LatLng(p[0],p[1])))}1==a&&(r.bounds=s,"undefined"!=typeof o.gfgeo_address_autocomplete_strict_bounds&&""!=o.gfgeo_address_autocomplete_strict_bounds&&(r.strictBounds=!0))}var f=document.getElementById(e);d.autocompletes[e]=new google.maps.places.Autocomplete(f,r),d.autocompletes[e].setFields(d.args.autocomplete_returned_fields),google.maps.event.addListener(d.autocompletes[e],"place_changed",function(t){d.geocoder_id=o.gfgeo_geocoder_id;var i=d.autocompletes[e].getPlace();i.geometry&&""!=d.geocoder_id&&(d.autocomplete_triggered=!0,d.processing_start("address_autocomplete",[i.geometry.location.lat(),i.geometry.location.lng()],i,d,f,o),jQuery(f).hasClass("advanced-address-autocomplete")?d.processing.advanced_address=!0:d.processing.advanced_address=!1,d.processing.selected_address=jQuery(f).val(),"undefined"!=typeof d.autocompletes[e].gm_accessors_.place.Td&&(d.processing.autocomplete_place=d.autocompletes[e].gm_accessors_.place.Td.formattedPrediction),jQuery(f).trigger("change"),d.save_location_fields(i,"address_autocomplete"),d["debugger"]("Address Autocomplete triggered. Field ID: "+e+". Geocoder ID: "+d.geocoder_id))})},GF_Geo.prototype.seconds_to_dhms=function(e){e=Number(e);var o=Math.floor(e/86400),t=Math.floor(e%86400/3600),d=Math.floor(e%3600/60),i=(Math.floor(e%60),o>0?o+(1==o?" day ":" days "):""),r=t>0?t+(1==t?" hour ":" hours "):"",s=d>0?d+(1==d?" minute ":" minutes "):"";return i+r+s},GF_Geo.prototype.haversine_distance_from_coords=function(e,o,t,d){var i=6371,r=e*(Math.PI/180),s=t*(Math.PI/180),a=s-r,n=(d-o)*(Math.PI/180),g=2*i*Math.asin(Math.sqrt(Math.sin(a/2)*Math.sin(a/2)+Math.cos(r)*Math.cos(s)*Math.sin(n/2)*Math.sin(n/2)));return g},GF_Geo.prototype.haversine_distance=function(e,o){var t=6371,d=e.lat()*(Math.PI/180),i=o.lat()*(Math.PI/180),r=i-d,s=(o.lng()-e.lng())*(Math.PI/180),a=2*t*Math.asin(Math.sqrt(Math.sin(r/2)*Math.sin(r/2)+Math.cos(d)*Math.cos(i)*Math.sin(s/2)*Math.sin(s/2)));return a=1e3*a,+a.toFixed(1)},GF_Geo.prototype.meters_convertor=function(e,o,t){return"text"==t?0==o?(e/1e3).toFixed(1)+" km":(.000621371192*e).toFixed(1)+" mi":0==o?(e/1e3).toFixed(1):(.000621371192*e).toFixed(1)},GF_Geo.prototype.get_polyline_options=function(e){var o={strokeColor:"#0088FF",strokeWeight:6,strokeOpacity:.6};if("undefined"!=typeof e&&""!=e){e=e.split(",");for(var t,d=0;d<e.length;d++)-1!=e[d].indexOf(":")&&(t=e[d].split(":"),-1!==jQuery.inArray(t[0],["strokeColor","strokeOpacity","strokeWeight"])&&(o[t[0]]=t[1]))}return o},GF_Geo.prototype.generate_directions_values=function(e,o,t){var d=this;d.generate_location_data(e,"distance_text",o.text),d.generate_location_data(e,"distance_value",o.text.replace(/[^0-9.,]/g,"")),d.generate_location_data(e,"distance_in_meters",o.value),d.generate_location_data(e,"duration_text",t.text),d.generate_location_data(e,"duration_value",t.value)},GF_Geo.prototype.get_directions=function(e,o){var t=this,d=t.directions_fields[e],i={fieldId:e,field:d,fieldUsage:"undefined"!=typeof d.gfgeo_directions_field_usage&&""!=d.gfgeo_directions_field_usage?d.gfgeo_directions_field_usage:"driving_directions",originGeocoderId:""!=d.gfgeo_origin_geocoder_id?d.gfgeo_origin_geocoder_id:"",destinationGeocoderId:""!=d.gfgeo_destination_geocoder_id?d.gfgeo_destination_geocoder_id:"",waypointsGeocoders:""!=d.gfgeo_waypoints_geocoders?d.gfgeo_waypoints_geocoders.map(function(e){return e}):[],unitSystem:d.gfgeo_unit_system,travelMode:d.gfgeo_travel_mode,mapId:""!=d.gfgeo_route_map_id?d.gfgeo_route_map_id:"",directionsPanel:""!=d.gfgeo_directions_panel_id?d.gfgeo_directions_panel_id:"",polylineOptions:""!=d.gfgeo_route_polyline_options?d.gfgeo_route_polyline_options:"",triggeredDynamically:o};"undefined"!=typeof gform&&(i=gform.applyFilters("gfgeo_get_directions_args",i,t)),"straight_line"==i.fieldUsage?t.get_straight_line_distance(i):t.get_driving_directions(i)},GF_Geo.prototype.get_straight_line_distance=function(e){var o=this;setTimeout(function(){var t=e.field,d=e.originGeocoderId,r=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d):"",s=e.destinationGeocoderId,a=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+s).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+s):"";if(o.processing_start("straight_line_distance",[]),""!=r&&"1"==r.find(".status").val()&&""!=a&&"1"==a.find(".status").val()){var n,g,_=r.find("input.latitude").val(),c=r.find("input.longitude").val(),l=r.find("input.address").val(),p=new google.maps.LatLng(_,c),f=a.find("input.latitude").val(),u=a.find("input.longitude").val(),m=a.find("input.address").val(),y=new google.maps.LatLng(f,u),v=e.fieldId,h="metric"==e.unitSystem?google.maps.UnitSystem.METRIC:google.maps.UnitSystem.IMPERIAL,b=e.mapId,j={},Q=0,G=0,w=""!=b&&jQuery("#gfgeo-map-"+b).length?!0:!1,k={text:"",value:0},F={text:"",value:0},L=d,I=p,x=l,M={origin:p,destination:y,waypoints:[],legs:[],complete:{distance:{value:"",text:""},duration:{value:"",text:""}}};if(j[d]=p,0!==e.waypointsGeocoders.length)for(i=0;i<e.waypointsGeocoders.length;i++){var E=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+e.waypointsGeocoders[i]).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+e.waypointsGeocoders[i]):"";""!=E&&"1"==E.find(".status").val()&&(wplat=E.find("input.latitude").val(),wplng=E.find("input.longitude").val(),g=E.find("input.address").val(),n=new google.maps.LatLng(wplat,wplng),j[e.waypointsGeocoders[i]]=n,Q=o.haversine_distance(I,n),k.value+=Q,M.legs.push({geocoders:[L,e.waypointsGeocoders[i]],addresses:[x,g],distance:{text:o.meters_convertor(Q,h,"text"),value:Q}}),I=n,L=e.waypointsGeocoders[i],G++)}j[s]=y,Q=o.haversine_distance(I,y),M.legs.push({geocoders:[L,s],addresses:[x,m],distance:{text:o.meters_convertor(Q,h,"text"),value:Q}}),k.value+=Q,k.text=o.meters_convertor(k.value,h,"text"),M.complete.distance.value=k.value,M.complete.distance.text=k.text;var O=JSON.stringify(M);if(jQuery("#input_"+t.gfgeo_id+".gfgeo-directions-field-value, #input_"+t.id+".gfgeo-directions-field-value").val(O),jQuery("#input_"+t.gfgeo_id+"_triggered, #input_"+t.id+"_triggered").val("1"),"undefined"!=typeof t.gfgeo_directions_panel_id&&"undefined"!=typeof o.fields[t.gfgeo_directions_panel_id]){var S=o.fields[t.gfgeo_directions_panel_id];jQuery("#input_"+S.gfgeo_id+", #input_"+S.id).val(O)}if(w){var D,A,P=Object.keys(j);for("undefined"!=typeof o.maps[b].polylines.directions[v]&&o.maps[b].polylines.directions[v].setMap(null),polylineOptions=o.get_polyline_options(e.polylineOptions),polylineOptions.path=Object.values(j),polylineOptions.map=o.maps[b].map,o.maps[b].polylines.directions[v]=new google.maps.Polyline(polylineOptions),o.maps[b].latLngBounds=new google.maps.LatLngBounds,i=0;i<P.length;i++)A=P[i],D=j[A],o.maps[b].latLngBounds.extend(D),"undefined"==typeof o.maps[b].markers[A]?(o.maps[b].markers[A]=o.render_marker(D,A,b),o.maps[b].markers[A].setMap(o.maps[b].map)):o.maps[b].markers[A].setPosition(D);o.maps[b].map.fitBounds(o.maps[b].latLngBounds)}o.generate_directions_values(v,k,F),jQuery(document).trigger("gfgeo_straight_line_distance_success",[v,k,F,M,e,o]),o.processing_end()}else if(1==e.triggeredDynamically)o.processing_end();else if(0==e.triggeredDynamically){var C="",T=!1;(""==r||"1"!=r.find("input.status").val())&&(T=!0,C=o.args.directions_missing_origin_message),(""==a||"1"!=a.find("input.status").val())&&(C=1==T?o.args.directions_missing_both_message:o.args.directions_missing_destination_message),alert(C),o.processing_end()}},500)},GF_Geo.prototype.get_driving_directions=function(e){var o=this;o.processing_start("driving_directions",[]);var t=e.field,d=e.originGeocoderId,r=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+d):"",s=e.destinationGeocoderId,a=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+s).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+s):"";if(""!=r&&"1"==r.find(".status").val()&&""!=a&&"1"==a.find(".status").val()){var n=e.fieldId,g=e.mapId,_=e.directionsPanel,c=""!=g&&jQuery("#gfgeo-map-"+g).length?!0:!1,l=""!=_?!0:!1,p=!1;if("undefined"==typeof o.directionsServices[n]&&(o.directionsServices[n]={response:"",directionsService:new google.maps.DirectionsService,DirectionsRenderer:!1,element:null}),null==o.directionsServices[n].element||o.directionsServices[n].element.is(jQuery("#gfgeo-directions-field-wrapper-"+n))||(p=!0),(0==o.directionsServices[n].DirectionsRenderer||1==p)&&(o.directionsServices[n].element=jQuery("#gfgeo-directions-field-wrapper-"+n),1==c||1==l)){var f={suppressMarkers:!0};1==c&&(f.map=o.maps[g].map,f.polylineOptions=o.get_polyline_options(e.polylineOptions),o.directionsServices[n].mapElement=jQuery("#gfgeo-map-"+g)),1==l&&(f.panel=document.getElementById("gfgeo-directions-panel-holder-"+_)),o.directionsServices[n].DirectionsRenderer=new google.maps.DirectionsRenderer(f),o.directionsServices[n].DirectionsRenderer.addListener("directions_changed",function(){var e=jQuery(this)[0].getPanel();"undefined"!==e&&jQuery(e).closest("li, tr").slideDown()})}if(!o.isEmpty(o.directionsServices[n].response)&&0!=o.directionsServices[n].DirectionsRenderer&&!o.args.disable_directions_cache)return console.log("Using cached directions"),o.directionsServices[n].DirectionsRenderer.setDirections(o.directionsServices[n].response),void o.processing_end();setTimeout(function(){var _,l,p=r.find("input.latitude").val(),f=r.find("input.longitude").val(),u=r.find("input.address").val(),m=new google.maps.LatLng(p,f),y=a.find("input.latitude").val(),v=a.find("input.longitude").val(),h=a.find("input.address").val(),b=new google.maps.LatLng(y,v),j=[],Q=[],G=!1,w="metric"==e.unitSystem?google.maps.UnitSystem.METRIC:google.maps.UnitSystem.IMPERIAL;if(0!==e.waypointsGeocoders.length)for(i=0;i<e.waypointsGeocoders.length;i++){var k=0!=jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+e.waypointsGeocoders[i]).length?jQuery("#gfgeo-geocoded-hidden-fields-wrapper-"+e.waypointsGeocoders[i]):"";""!=k&&"1"==k.find(".status").val()&&(_=k.find(".latitude").val(),l=k.find(".longitude").val(),j.push({location:new google.maps.LatLng(_,l),stopover:!0}),Q.push(e.waypointsGeocoders[i]),G=!0)}var F={origin:m,destination:b,travelMode:e.travelMode,unitSystem:w,waypoints:j,optimizeWaypoints:G};"undefined"!=typeof gform&&(F=gform.applyFilters("gfgeo_driving_directions_options",F,d,s,o,e)),o.directionsServices[n].directionsService.route(F,function(r,a){if("OK"==a){console.log("Calculating new directions"),o.directionsServices[n].response=r;var _={text:"",value:0},l={text:"",value:0},p=[d],f=r.routes[0].legs.slice(),y={origin:m,destination:b,waypoints:[],legs:[],complete:{distance:{value:"",text:""},duration:{value:"",text:""}}};if(0!=o.directionsServices[n].DirectionsRenderer&&o.directionsServices[n].DirectionsRenderer.setDirections(r),"undefined"!=typeof Q&&r.routes[0].legs.length>1){var v=r.routes[0].waypoint_order;for(i=0;i<v.length;i++)p.push(Q[v[i]])}for(p.push(s),i=0;i<p.length;i++)geocoderId=p[i],i<p.length-1?(markerPosition=f[i].start_location,_.value+=f[i].distance.value,l.value+=f[i].duration.value,y.waypoints.push(f[i].end_location),y.legs.push({geocoders:[geocoderId,p[i+1]],addresses:[f[i].start_address,f[i].end_address],distance:f[i].distance,duration:f[i].duration})):i==p.length-1&&(markerPosition=f[i-1].end_location),1==c&&("undefined"==typeof o.maps[g].markers[geocoderId]?(o.maps[g].markers[geocoderId]=o.render_marker(markerPosition,geocoderId,g),o.maps[g].markers[geocoderId].setMap(o.maps[g].map)):o.maps[g].markers[geocoderId].setPosition(markerPosition));l.text=o.seconds_to_dhms(l.value),_.text=0==w?(_.value/1e3).toFixed(1)+" km":(.000621371192*_.value).toFixed(1)+" mi",y.complete.distance.value=_.value,y.complete.distance.text=_.text,y.complete.duration.value=l.value,y.complete.duration.text=l.text;var j=JSON.stringify(y);if(jQuery("#input_"+t.gfgeo_id+".gfgeo-directions-field-value, #input_"+t.id+".gfgeo-directions-field-value").val(j),jQuery("#input_"+t.gfgeo_id+"_triggered, #input_"+t.id+"_triggered").val("1"),"undefined"!=typeof t.gfgeo_directions_panel_id&&"undefined"!=typeof o.fields[t.gfgeo_directions_panel_id]){var G=o.fields[t.gfgeo_directions_panel_id];jQuery("#input_"+G.gfgeo_id+", #input_"+G.id).val(j)}o.generate_directions_values(n,_,l),o.generate_directions_values(d,_,l),jQuery(document).trigger("gfgeo_driving_directions_success",[n,_,l,y,e,r,o]),o.processing_end()}else{if(console.log(a),"ZERO_RESULTS"==a){var k=o.args.directions_failed_message;alert(k.replace("%origin%",u).replace("%destination%",h))}jQuery(document).trigger("gfgeo_driving_directions_failed",[n,e,r,o]),o.processing_end()}})},1e3)}else if(1==e.triggeredDynamically)o.processing_end();else if(0==e.triggeredDynamically){var u="",m=!1;(""==r||"1"!=r.find("input.status").val())&&(m=!0,u=o.args.directions_missing_origin_message),(""==a||"1"!=a.find("input.status").val())&&(u=1==m?o.args.directions_missing_both_message:o.args.directions_missing_destination_message),alert(u),o.processing_end()}},GF_Geo.prototype.generate_location_data=function(e,o,t){jQuery("input.gfgeo-geocoded-field-"+e+"."+o+'[type="hidden"]').val(t).trigger("change");var d=".gfgeo-dynamic-"+o+"-"+e;jQuery(d).find('input[type="text"], input[type="hidden"], input[type="number"], select').val(t).trigger("change"),jQuery(d).find('input[type="checkbox"][value="'+t+'"], input[type="radio"][value="'+t+'"]').prop("checked",!0).trigger("change");var i=".gfgeo-advanced-address-"+o+"-"+e;jQuery('input[type="text"]'+i+',input[type="hidden"]'+i+",select"+i).val(t).trigger("change")},GF_Geo.prototype.get_place_details=function(e,o,t){var d=this;if(void 0!==o.name)d.generate_location_data(d.geocoder_id,"place_name",o.name);else{var i=new google.maps.places.PlacesService(jQuery("<div>").get(0)),r={placeId:e.place_id,fields:d.args.get_details_returned_fields};i.getDetails(r,function(i,r){"OK"==r&&(void 0!==i.name&&d.generate_location_data(d.geocoder_id,"place_name",i.name),jQuery(document).trigger("gfgeo_place_details",[i,o,e,t,d]))})}},GF_Geo.prototype.save_location_fields=function(e,o){var t=this;if(console.log(e),0!=t.processing.locator_id&&""!=t.processing.locator_id&&jQuery("#gfgeo-infield-locator-button-"+t.processing.locator_id).closest(".gfield").find(".gfgeo-address-field").val(e.formatted_address).trigger("change"),""==t.geocoder_id)return void t.processing_end();if(jQuery(document).trigger("gfgeo_save_location_data_start",[e,o,t]),t.clear_fields(t.geocoder_id,o,!0),address_fields={street_number:"",street_name:"",street:"",street_nsp:"",street_bw:"",street_bw_nsp:"",premise:"",subpremise:"",neighborhood:"",city:"",region_code:"",region_name:"",country:"",postcode:"",country_code:"",country_name:"",address:e.formatted_address,formatted_address:e.formatted_address,lat:"",lng:"",place_id:e.place_id||"",distance:"",duration:""},"coords_geocoder"==o||"map"==o?(address_fields.lat=t.processing.location[0],address_fields.lng=t.processing.location[1]):(address_fields.lat=e.geometry.location.lat(),address_fields.lng=e.geometry.location.lng()),("address_geocoder"==o||"advanced_address_geocoder"==o)&&"string"==typeof t.processing.location&&(address_fields.address=t.processing.location.trim()),"address_autocomplete"==o&&(address_fields.address=t.processing.selected_address),jQuery.each(t.maps,function(e,d){("map"!=o||"map"==o&&e!=t.processing.element_id)&&-1!==jQuery.inArray(t.geocoder_id,d.geocodersId)&&t.update_map(e,t.geocoder_id,address_fields.lat,address_fields.lng)}),"page_locator"==o&&0!=jQuery('input[data-geocoder_id="'+t.geocoder_id+'"][data-address_autocomplete="1"][data-autocomplete_locator_bounds="1"]').length&&address_fields.lat){var d=jQuery('input[data-geocoder_id="'+t.geocoder_id+'"][data-address_autocomplete="1"][data-autocomplete_locator_bounds="1"]').attr("id"),i=new google.maps.Circle({center:{lat:address_fields.lat,lng:address_fields.lng}});t.autocompletes[d].setBounds(i.getBounds())}if(t.generate_location_data(t.geocoder_id,"latitude",address_fields.lat),t.generate_location_data(t.geocoder_id,"longitude",address_fields.lng),jQuery('.gfgeo-latitude-field[data-geocoder_id="'+t.geocoder_id+'"]').val(address_fields.lat).trigger("change"),jQuery('.gfgeo-longitude-field[data-geocoder_id="'+t.geocoder_id+'"]').val(address_fields.lng).trigger("change"),"map"==o){var r=t.maps[t.processing.element_id],s=r.markers[r.draggedMarker].gfgeoArgs.disableAddressOutput;if(1==s)return jQuery("input.gfgeo-geocoded-field-"+t.geocoder_id+".status").val("1").trigger("change"),t.processing_end(),address_fields}"address_geocoder"!=o&&("address_autocomplete"!=o||"address_autocomplete"==o&&1==t.processing.advanced_address)&&jQuery('.gfgeo-address-field[data-geocoder_id="'+t.geocoder_id+'"]').val(e.formatted_address).trigger("change"),t.generate_location_data(t.geocoder_id,"address",address_fields.address),t.generate_location_data(t.geocoder_id,"formatted_address",address_fields.formatted_address),address_fields.place_id&&(jQuery(".gfgeo-place_name").length||1==t.args.place_details_enabled)&&t.get_place_details(address_fields,e,o),address=e.address_components||[];var a=!1,n=!1;for(var g in address){if("street_number"==address[g].types&&void 0!=address[g].long_name&&(address_fields.street_number=address[g].long_name,t.generate_location_data(t.geocoder_id,"street_number",address_fields.street_number)),"subpremise"==address[g].types&&void 0!=address[g].long_name&&(address_fields.subpremise=address[g].long_name,t.generate_location_data(t.geocoder_id,"subpremise",address_fields.subpremise)),"route"==address[g].types&&void 0!=address[g].long_name){if(address_fields.street_name=address[g].long_name,t.generate_location_data(t.geocoder_id,"street_name",address_fields.street_name),""!=address_fields.street_number){var _=" ";""!=address_fields.subpremise&&(_="/"+address_fields.subpremise+" "),address_fields.street=address_fields.street_number+_+address_fields.street_name,address_fields.street_nsp=address_fields.street_number+" "+address_fields.street_name,address_fields.street_bw=address_fields.street_name+_+address_fields.street_number,address_fields.street_bw_nsp=address_fields.street_name+" "+address_fields.street_number}else address_fields.street=address_fields.street_name,address_fields.street_nsp=address_fields.street_name,address_fields.street_bw=address_fields.street_name,address_fields.street_bw_nsp=address_fields.street_name;t.generate_location_data(t.geocoder_id,"street",address_fields.street),t.generate_location_data(t.geocoder_id,"street_nsp",address_fields.street_nsp),t.generate_location_data(t.geocoder_id,"street_bw",address_fields.street_bw),t.generate_location_data(t.geocoder_id,"street_bw_nsp",address_fields.street_bw_nsp)}"premise"==address[g].types&&void 0!=address[g].long_name&&(address_fields.premise=address[g].long_name,t.generate_location_data(t.geocoder_id,"premise",address_fields.premise)),"neighborhood,political"==address[g].types&&void 0!=address[g].long_name&&(address_fields.neighborhood=address[g].long_name,t.generate_location_data(t.geocoder_id,"neighborhood",address_fields.neighborhood)),"locality,political"==address[g].types&&void 0!=address[g].long_name&&(address_fields.city=address[g].long_name,t.generate_location_data(t.geocoder_id,"city",address_fields.city),a=!0),"administrative_area_level_3,political"==address[g].types&&void 0!=address[g].long_name&&(n=address[g].long_name),a||"political,sublocality,sublocality_level_1"!=address[g].types||void 0==address[g].long_name||(address_fields.city=address[g].long_name,t.generate_location_data(t.geocoder_id,"city",address_fields.city),a=!0),a||"postal_town"!=address[g].types||void 0==address[g].long_name||(address_fields.city=address[g].long_name,t.generate_location_data(t.geocoder_id,"city",address_fields.city),a=!0),"administrative_area_level_2,political"==address[g].types&&void 0!=address[g].long_name&&(address_fields.county=address[g].long_name,t.generate_location_data(t.geocoder_id,"county",address_fields.county)),"administrative_area_level_1,political"==address[g].types&&(address_fields.region_name=address[g].long_name,address_fields.region_code=address[g].short_name,t.generate_location_data(t.geocoder_id,"region_code",address_fields.region_code),t.generate_location_data(t.geocoder_id,"region_name",address_fields.region_name)),"postal_code"==address[g].types&&void 0!=address[g].long_name&&(address_fields.postcode=address[g].long_name,t.generate_location_data(t.geocoder_id,"postcode",address_fields.postcode)),"country,political"==address[g].types&&(address_fields.country_name=address[g].long_name,address_fields.country_code=address[g].short_name,t.generate_location_data(t.geocoder_id,"country_code",address_fields.country_code),t.generate_location_data(t.geocoder_id,"country_name",address_fields.country_name)),jQuery(document).trigger("gfgeo_save_location_field_data",[address[g],t,e,o])}return a||0==n||t.generate_location_data(t.geocoder_id,"city",n),jQuery("input.gfgeo-geocoded-field-"+t.geocoder_id+".status").val("1").trigger("change"),t.init_load_processing||jQuery.isEmptyObject(t.directions_fields)&&jQuery.isEmptyObject(t.geocoder_directions_fields)?t.processing_end():(jQuery.isEmptyObject(t.directions_fields)||jQuery.each(t.directions_fields,function(e,o){"button"==o.gfgeo_trigger_directions_method?!(t.inArray(t.geocoder_id,o.gfgeo_waypoints_geocoders)>-1)||t.isEmpty(jQuery("#input_"+o.gfgeo_id+"_triggered").val())&&t.isEmpty(jQuery("#input_"+o.id+"_triggered").val())?t.processing_end():t.get_directions(e,!1):t.inArray(t.geocoder_id,o.total_geocoders)>-1?t.get_directions(e,!0):t.processing_end()}),jQuery.isEmptyObject(t.geocoder_directions_fields)||jQuery.each(t.geocoder_directions_fields,function(e,o){if(t.inArray(t.geocoder_id,o.total_geocoders)>-1){var d={fieldId:e,field:o,fieldUsage:"driving_directions",originGeocoderId:e,destinationGeocoderId:o.gfgeo_distance_destination_geocoder_id,waypointsGeocoders:[],unitSystem:o.gfgeo_distance_unit_system,travelMode:o.gfgeo_distance_travel_mode,mapId:o.gfgeo_route_map_id,directionsPanel:""!=o.gfgeo_distance_directions_panel_id?o.gfgeo_distance_directions_panel_id:"",polylineOptions:"",triggeredDynamically:!0};t.get_driving_directions(d)}else t.processing_end()})),jQuery(document).trigger("gfgeo_save_location_data_end",[address_fields,t,e,o]),address_fields};var GFGeo_Autocomplete_Visible=!1;jQuery(document).on("mouseenter mouseleave",".pac-container:visible",function(e){GFGeo_Autocomplete_Visible="mouseenter"===e.type?!0:!1}),"false"==gfgeo_options.is_admin?jQuery(document).bind("gform_post_render",function(e,o,t){return"undefined"!=typeof t&&"undefined"!=typeof gfgeo_gforms[o]&&jQuery("#gform_wrapper_"+o).length?("undefined"==typeof GFGeo_Forms[o]&&(GFGeo_Forms[o]=new GF_Geo(gfgeo_gforms[o],t)),void GFGeo_Forms[o].init()):(console.log("something went wrong while trying to retrive the form object."),!1)}):jQuery(document).ready(function(e){if(0==gfgeo_options.edit_entry_form_id||"undefined"==typeof gfgeo_gforms[gfgeo_options.edit_entry_form_id]||!jQuery("#entry_form").length)return console.log("something went wrong while trying to retrive the form object."),!1;if("false"==gfgeo_options.disable_script_init){var o=gfgeo_options.edit_entry_form_id;"undefined"==typeof GFGeo_Forms[o]&&(GFGeo_Forms[o]=new GF_Geo(gfgeo_gforms[o],1)),GFGeo_Forms[o].init()}});